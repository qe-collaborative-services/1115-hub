{
  "args": {
    "walkRootPaths": [
      "support/assurance/ahc-hrsn-elt/screening/synthetic-content"
    ],
    "diagsJson": "support/assurance/ahc-hrsn-elt/screening/results-test-e2e/diagnostics.json",
    "diagsMd": "support/assurance/ahc-hrsn-elt/screening/results-test-e2e/diagnostics.md",
    "diagsXlsx": "support/assurance/ahc-hrsn-elt/screening/results-test-e2e/diagnostics.xlsx",
    "resourceDb": "support/assurance/ahc-hrsn-elt/screening/results-test-e2e/resource.sqlite.db",
    "sources": [
      {
        "uri": "support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv",
        "nature": "CSV",
        "tableName": "ahc_hrsn_12_12_2023_valid",
        "ingestionIssues": 0
      },
      {
        "uri": "support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx",
        "nature": "Excel Workbook Sheet",
        "tableName": "ahc_hrsn_valid_01_admin_demographic",
        "ingestionIssues": 1
      },
      {
        "uri": "support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx",
        "nature": "Excel Workbook Sheet",
        "tableName": "ahc_hrsn_valid_01_screening",
        "ingestionIssues": 12
      },
      {
        "uri": "support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx",
        "nature": "Excel Workbook Sheet",
        "tableName": "ahc_hrsn_valid_01_q_e_admin_data",
        "ingestionIssues": 1
      },
      {
        "uri": "support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx",
        "nature": "ERROR",
        "tableName": "ERROR",
        "ingestionIssues": 1
      },
      {
        "uri": "support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx",
        "nature": "ERROR",
        "tableName": "ERROR",
        "ingestionIssues": 1
      },
      {
        "uri": "support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv",
        "nature": "CSV",
        "tableName": "synthetic_fail",
        "ingestionIssues": 21
      }
    ]
  },
  "diags": [
    {
      "insertable": {
        "exec_identity": "init",
        "exec_code": "duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'Shaju', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"windows\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES ('05e8feaa-0bed-5909-a817-39812494b361', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', (make_timestamp(2024, 1, 3, 14, 30, 25.781)), NULL, NULL, NULL, NULL, 'Session 05e8feaa-0bed-5909-a817-39812494b361 markdown diagnostics not provided (not completed?)');\n\n-- no after-init SQL found",
        "orch_session_exec_id": "168a34c7-d043-5ec4-a84a-c961f1a301ef",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'Shaju', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"windows\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES ('05e8feaa-0bed-5909-a817-39812494b361', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', (make_timestamp(2024, 1, 3, 14, 30, 25.781)), NULL, NULL, NULL, NULL, 'Session 05e8feaa-0bed-5909-a817-39812494b361 markdown diagnostics not provided (not completed?)');\n\n-- no after-init SQL found",
        "session_id": "05e8feaa-0bed-5909-a817-39812494b361",
        "narrative_md": "\n## init\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'Shaju', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"windows\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES ('05e8feaa-0bed-5909-a817-39812494b361', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', (make_timestamp(2024, 1, 3, 14, 30, 25.781)), NULL, NULL, NULL, NULL, 'Session 05e8feaa-0bed-5909-a817-39812494b361 markdown diagnostics not provided (not completed?)');\n\n-- no after-init SQL found\n```\nNo STDOUT emitted by `init` (status: `0`).\n\nNo STDERR emitted by `init`.\n\n    "
      }
    },
    {
      "insertable": {
        "exec_identity": "ingest",
        "exec_code": "duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb --json",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8b7c669c-1795-5f6b-8f3a-3e502b74c628', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv', 'ahc_hrsn_12_12_2023_valid', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7b979b68-7227-53fd-b689-e4fe153afb76', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'NONE', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, '8b7c669c-1795-5f6b-8f3a-3e502b74c628' as session_entry_id\n    FROM read_csv_auto('support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_12_12_2023_valid')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_12_12_2023_valid.',\n           'Ensure ahc_hrsn_12_12_2023_valid contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('abf5c680-a135-5d89-b871-fa5b9b99aed6', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('641dff51-97fd-56b3-8443-c1ed568a6d66', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_admin_demographic', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('d70a4700-6b40-52fc-a7a2-69ef0d7f69ff', '05e8feaa-0bed-5909-a817-39812494b361', '641dff51-97fd-56b3-8443-c1ed568a6d66', 'TODO', 'Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('47277588-99e8-59f5-8384-b24344a86073', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_screening', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('58b22e99-5854-53bf-adbe-08e67df99b85', '05e8feaa-0bed-5909-a817-39812494b361', '47277588-99e8-59f5-8384-b24344a86073', 'NONE', 'ATTEMPT_EXCEL_INGEST', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Screening' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, '47277588-99e8-59f5-8384-b24344a86073' as session_entry_id\n    FROM st_read('support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', layer='Screening', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_valid_01_screening')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '47277588-99e8-59f5-8384-b24344a86073',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_valid_01_screening.',\n           'Ensure ahc_hrsn_valid_01_screening contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a26ce332-3ced-5623-861d-23a2ef78e4a9', '05e8feaa-0bed-5909-a817-39812494b361', '47277588-99e8-59f5-8384-b24344a86073', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_q_e_admin_data', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('ae477ba1-c7f1-5f34-847a-50bddb7130aa', '05e8feaa-0bed-5909-a817-39812494b361', 'bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', 'TODO', 'Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', '05e8feaa-0bed-5909-a817-39812494b361', '8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('591191c7-f693-5957-8734-ac87151ca981', '05e8feaa-0bed-5909-a817-39812494b361', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('3b4eb0e5-6239-537a-8e67-e50e172e72a2', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('071f8fe1-4899-5c71-9c86-7d7377661d45', '05e8feaa-0bed-5909-a817-39812494b361', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('86b4a49e-7378-5159-9f41-b005208c31bc', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('a530fe1b-57ef-5a90-8bea-835ece2483da', '05e8feaa-0bed-5909-a817-39812494b361', '86b4a49e-7378-5159-9f41-b005208c31bc', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('a3fe7098-8ae8-5612-81ac-cbe10780c19b', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('99e72a60-96ab-5ef1-a3af-3e7759777664', '05e8feaa-0bed-5909-a817-39812494b361', 'a3fe7098-8ae8-5612-81ac-cbe10780c19b', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('e36daa69-3c63-5384-b6a7-03fa3b00641d', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('89f7ec04-277a-5799-afaa-a70d0f2a8ed5', '05e8feaa-0bed-5909-a817-39812494b361', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('c60cf3db-b1bf-5103-b278-b0c128ce924a', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv', 'synthetic_fail', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', '05e8feaa-0bed-5909-a817-39812494b361', 'c60cf3db-b1bf-5103-b278-b0c128ce924a', 'NONE', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, 'c60cf3db-b1bf-5103-b278-b0c128ce924a' as session_entry_id\n    FROM read_csv_auto('support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'synthetic_fail')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           'c60cf3db-b1bf-5103-b278-b0c128ce924a',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in synthetic_fail.',\n           'Ensure synthetic_fail contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b10e248d-8c94-59ec-83fc-a1249dd3b111', '05e8feaa-0bed-5909-a817-39812494b361', 'c60cf3db-b1bf-5103-b278-b0c128ce924a', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = '05e8feaa-0bed-5909-a817-39812494b361'",
        "output_nature": "JSON",
        "orch_session_exec_id": "5222b730-9add-5b52-b0c9-6f2506b0af9d",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8b7c669c-1795-5f6b-8f3a-3e502b74c628', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv', 'ahc_hrsn_12_12_2023_valid', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7b979b68-7227-53fd-b689-e4fe153afb76', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'NONE', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, '8b7c669c-1795-5f6b-8f3a-3e502b74c628' as session_entry_id\n    FROM read_csv_auto('support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_12_12_2023_valid')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_12_12_2023_valid.',\n           'Ensure ahc_hrsn_12_12_2023_valid contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('abf5c680-a135-5d89-b871-fa5b9b99aed6', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('641dff51-97fd-56b3-8443-c1ed568a6d66', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_admin_demographic', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('d70a4700-6b40-52fc-a7a2-69ef0d7f69ff', '05e8feaa-0bed-5909-a817-39812494b361', '641dff51-97fd-56b3-8443-c1ed568a6d66', 'TODO', 'Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('47277588-99e8-59f5-8384-b24344a86073', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_screening', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('58b22e99-5854-53bf-adbe-08e67df99b85', '05e8feaa-0bed-5909-a817-39812494b361', '47277588-99e8-59f5-8384-b24344a86073', 'NONE', 'ATTEMPT_EXCEL_INGEST', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Screening' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, '47277588-99e8-59f5-8384-b24344a86073' as session_entry_id\n    FROM st_read('support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', layer='Screening', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_valid_01_screening')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '47277588-99e8-59f5-8384-b24344a86073',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_valid_01_screening.',\n           'Ensure ahc_hrsn_valid_01_screening contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a26ce332-3ced-5623-861d-23a2ef78e4a9', '05e8feaa-0bed-5909-a817-39812494b361', '47277588-99e8-59f5-8384-b24344a86073', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_q_e_admin_data', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('ae477ba1-c7f1-5f34-847a-50bddb7130aa', '05e8feaa-0bed-5909-a817-39812494b361', 'bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', 'TODO', 'Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', '05e8feaa-0bed-5909-a817-39812494b361', '8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('591191c7-f693-5957-8734-ac87151ca981', '05e8feaa-0bed-5909-a817-39812494b361', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('3b4eb0e5-6239-537a-8e67-e50e172e72a2', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('071f8fe1-4899-5c71-9c86-7d7377661d45', '05e8feaa-0bed-5909-a817-39812494b361', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('86b4a49e-7378-5159-9f41-b005208c31bc', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('a530fe1b-57ef-5a90-8bea-835ece2483da', '05e8feaa-0bed-5909-a817-39812494b361', '86b4a49e-7378-5159-9f41-b005208c31bc', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('a3fe7098-8ae8-5612-81ac-cbe10780c19b', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('99e72a60-96ab-5ef1-a3af-3e7759777664', '05e8feaa-0bed-5909-a817-39812494b361', 'a3fe7098-8ae8-5612-81ac-cbe10780c19b', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('e36daa69-3c63-5384-b6a7-03fa3b00641d', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('89f7ec04-277a-5799-afaa-a70d0f2a8ed5', '05e8feaa-0bed-5909-a817-39812494b361', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('c60cf3db-b1bf-5103-b278-b0c128ce924a', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv', 'synthetic_fail', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', '05e8feaa-0bed-5909-a817-39812494b361', 'c60cf3db-b1bf-5103-b278-b0c128ce924a', 'NONE', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, 'c60cf3db-b1bf-5103-b278-b0c128ce924a' as session_entry_id\n    FROM read_csv_auto('support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'synthetic_fail')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           'c60cf3db-b1bf-5103-b278-b0c128ce924a',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in synthetic_fail.',\n           'Ensure synthetic_fail contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b10e248d-8c94-59ec-83fc-a1249dd3b111', '05e8feaa-0bed-5909-a817-39812494b361', 'c60cf3db-b1bf-5103-b278-b0c128ce924a', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = '05e8feaa-0bed-5909-a817-39812494b361'",
        "output_text": "[{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook 'ahc-hrsn-valid-01.xlsx' sheet 'Admin_Demographic' has not been implemented yet.\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\ahc-hrsn-valid-01.xlsx\"},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"58821d95-8a89-47f3-af13-7be681531d40\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"9dd3301c-464b-43fa-89c4-97d79e57b86f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"9fef81b3-cd5d-4447-ae1d-9421207a3ded\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"020c16c7-b208-4bb9-8f2e-c4b64db30561\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"5d3e9ae5-a603-42b6-aac6-c29f27c9f086\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"dcf02031-a395-4b9c-a3dc-6c038f6d0e3e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"cfee50d5-6b5c-4526-b783-e1d60a7676bc\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"24c3f824-9559-4ea8-b5b3-be31fc6ba704\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"366661bc-9ace-480e-a598-e389647c8384\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"028364d1-8b23-4892-94ad-91e83a9101c2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"146e26dc-7378-4fff-8fd5-78cab94ae3cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"6c28fd55-b2ac-49c2-8874-8162a42dd784\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook 'ahc-hrsn-valid-01.xlsx' sheet 'QE_Admin_Data' has not been implemented yet.\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\ahc-hrsn-valid-01.xlsx\"},\r\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Admin_Demographic' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49\",\"orch_session_issue_id\":\"591191c7-f693-5957-8734-ac87151ca981\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Screening' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"3b4eb0e5-6239-537a-8e67-e50e172e72a2\",\"orch_session_issue_id\":\"071f8fe1-4899-5c71-9c86-7d7377661d45\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'QE_Admin_Data' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"86b4a49e-7378-5159-9f41-b005208c31bc\",\"orch_session_issue_id\":\"a530fe1b-57ef-5a90-8bea-835ece2483da\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Admin_Demographic' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"a3fe7098-8ae8-5612-81ac-cbe10780c19b\",\"orch_session_issue_id\":\"99e72a60-96ab-5ef1-a3af-3e7759777664\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Screening' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"e36daa69-3c63-5384-b6a7-03fa3b00641d\",\"orch_session_issue_id\":\"89f7ec04-277a-5799-afaa-a70d0f2a8ed5\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'QE_Admin_Data' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"72107c98-a89b-44c0-985e-6fe19502d326\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"262b3ee4-4854-410b-989d-94297e82fa57\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"d646b6eb-9067-40a5-bdca-0efb462c3706\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"863cb049-64d6-4ef4-a176-79222f4e6ddf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"09f5833f-732a-41b4-821a-63cf311d68cd\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"91b545b8-899e-4ea8-ba07-be3d09c8a27a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"ee83a333-4eba-4acc-98be-618a58903e1a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"f9a27b22-f294-40cf-8f07-a3ca9409fbc5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"4dbeba36-21b5-42e2-91e8-e9e3ebc493b1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"ab0a8a0c-476c-42c1-888d-d85a475c4762\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"1726d423-5198-4e54-adf2-bcdfa85882c7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"426869bc-0a6c-48fa-b5af-8fc88110c25b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"27f3492d-47e0-4288-abdd-330893c3fac3\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"576962a7-38c3-4b79-9b79-21aace807962\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"3f0206be-254e-46fc-b888-19c699916d4f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"6cbd3991-ed27-4385-b4ec-912c9b4bf63b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"74cc493d-f2fa-41ed-bd9f-51474f376322\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"93ca82f9-b3d0-4fe5-8e2e-76bb3bea3ebc\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"197d16a4-eb4e-445b-b441-7a74a2bf494a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"876cb960-7f73-4a2b-aaa9-15f1895198f2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"4d85a3e8-41f5-4247-b81f-d3f0c3b5fb2a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null}]\r\n",
        "session_id": "05e8feaa-0bed-5909-a817-39812494b361",
        "narrative_md": "\n## ingest\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8b7c669c-1795-5f6b-8f3a-3e502b74c628', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv', 'ahc_hrsn_12_12_2023_valid', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7b979b68-7227-53fd-b689-e4fe153afb76', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'NONE', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, '8b7c669c-1795-5f6b-8f3a-3e502b74c628' as session_entry_id\n    FROM read_csv_auto('support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_12_12_2023_valid')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_12_12_2023_valid.',\n           'Ensure ahc_hrsn_12_12_2023_valid contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('abf5c680-a135-5d89-b871-fa5b9b99aed6', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('641dff51-97fd-56b3-8443-c1ed568a6d66', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_admin_demographic', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('d70a4700-6b40-52fc-a7a2-69ef0d7f69ff', '05e8feaa-0bed-5909-a817-39812494b361', '641dff51-97fd-56b3-8443-c1ed568a6d66', 'TODO', 'Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('47277588-99e8-59f5-8384-b24344a86073', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_screening', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('58b22e99-5854-53bf-adbe-08e67df99b85', '05e8feaa-0bed-5909-a817-39812494b361', '47277588-99e8-59f5-8384-b24344a86073', 'NONE', 'ATTEMPT_EXCEL_INGEST', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Screening' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, '47277588-99e8-59f5-8384-b24344a86073' as session_entry_id\n    FROM st_read('support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', layer='Screening', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_valid_01_screening')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '47277588-99e8-59f5-8384-b24344a86073',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_valid_01_screening.',\n           'Ensure ahc_hrsn_valid_01_screening contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a26ce332-3ced-5623-861d-23a2ef78e4a9', '05e8feaa-0bed-5909-a817-39812494b361', '47277588-99e8-59f5-8384-b24344a86073', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_q_e_admin_data', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('ae477ba1-c7f1-5f34-847a-50bddb7130aa', '05e8feaa-0bed-5909-a817-39812494b361', 'bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', 'TODO', 'Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', '05e8feaa-0bed-5909-a817-39812494b361', '8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('591191c7-f693-5957-8734-ac87151ca981', '05e8feaa-0bed-5909-a817-39812494b361', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('3b4eb0e5-6239-537a-8e67-e50e172e72a2', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('071f8fe1-4899-5c71-9c86-7d7377661d45', '05e8feaa-0bed-5909-a817-39812494b361', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('86b4a49e-7378-5159-9f41-b005208c31bc', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('a530fe1b-57ef-5a90-8bea-835ece2483da', '05e8feaa-0bed-5909-a817-39812494b361', '86b4a49e-7378-5159-9f41-b005208c31bc', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('a3fe7098-8ae8-5612-81ac-cbe10780c19b', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('99e72a60-96ab-5ef1-a3af-3e7759777664', '05e8feaa-0bed-5909-a817-39812494b361', 'a3fe7098-8ae8-5612-81ac-cbe10780c19b', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('e36daa69-3c63-5384-b6a7-03fa3b00641d', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('89f7ec04-277a-5799-afaa-a70d0f2a8ed5', '05e8feaa-0bed-5909-a817-39812494b361', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('c60cf3db-b1bf-5103-b278-b0c128ce924a', '05e8feaa-0bed-5909-a817-39812494b361', 'support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv', 'synthetic_fail', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', '05e8feaa-0bed-5909-a817-39812494b361', 'c60cf3db-b1bf-5103-b278-b0c128ce924a', 'NONE', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, 'c60cf3db-b1bf-5103-b278-b0c128ce924a' as session_entry_id\n    FROM read_csv_auto('support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'synthetic_fail')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           'c60cf3db-b1bf-5103-b278-b0c128ce924a',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in synthetic_fail.',\n           'Ensure synthetic_fail contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b10e248d-8c94-59ec-83fc-a1249dd3b111', '05e8feaa-0bed-5909-a817-39812494b361', 'c60cf3db-b1bf-5103-b278-b0c128ce924a', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = '05e8feaa-0bed-5909-a817-39812494b361'\n```\n### `ingest` STDOUT (status: `0`)\n```json\n[{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook 'ahc-hrsn-valid-01.xlsx' sheet 'Admin_Demographic' has not been implemented yet.\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\ahc-hrsn-valid-01.xlsx\"},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"58821d95-8a89-47f3-af13-7be681531d40\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"9dd3301c-464b-43fa-89c4-97d79e57b86f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"9fef81b3-cd5d-4447-ae1d-9421207a3ded\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"020c16c7-b208-4bb9-8f2e-c4b64db30561\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"5d3e9ae5-a603-42b6-aac6-c29f27c9f086\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"dcf02031-a395-4b9c-a3dc-6c038f6d0e3e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"cfee50d5-6b5c-4526-b783-e1d60a7676bc\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"24c3f824-9559-4ea8-b5b3-be31fc6ba704\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"366661bc-9ace-480e-a598-e389647c8384\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"028364d1-8b23-4892-94ad-91e83a9101c2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"146e26dc-7378-4fff-8fd5-78cab94ae3cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"6c28fd55-b2ac-49c2-8874-8162a42dd784\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook 'ahc-hrsn-valid-01.xlsx' sheet 'QE_Admin_Data' has not been implemented yet.\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\ahc-hrsn-valid-01.xlsx\"},\r\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Admin_Demographic' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49\",\"orch_session_issue_id\":\"591191c7-f693-5957-8734-ac87151ca981\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Screening' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"3b4eb0e5-6239-537a-8e67-e50e172e72a2\",\"orch_session_issue_id\":\"071f8fe1-4899-5c71-9c86-7d7377661d45\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'QE_Admin_Data' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"86b4a49e-7378-5159-9f41-b005208c31bc\",\"orch_session_issue_id\":\"a530fe1b-57ef-5a90-8bea-835ece2483da\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Admin_Demographic' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"a3fe7098-8ae8-5612-81ac-cbe10780c19b\",\"orch_session_issue_id\":\"99e72a60-96ab-5ef1-a3af-3e7759777664\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Screening' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"e36daa69-3c63-5384-b6a7-03fa3b00641d\",\"orch_session_issue_id\":\"89f7ec04-277a-5799-afaa-a70d0f2a8ed5\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'QE_Admin_Data' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"72107c98-a89b-44c0-985e-6fe19502d326\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"262b3ee4-4854-410b-989d-94297e82fa57\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"d646b6eb-9067-40a5-bdca-0efb462c3706\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"863cb049-64d6-4ef4-a176-79222f4e6ddf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"09f5833f-732a-41b4-821a-63cf311d68cd\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"91b545b8-899e-4ea8-ba07-be3d09c8a27a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"ee83a333-4eba-4acc-98be-618a58903e1a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"f9a27b22-f294-40cf-8f07-a3ca9409fbc5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"4dbeba36-21b5-42e2-91e8-e9e3ebc493b1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"ab0a8a0c-476c-42c1-888d-d85a475c4762\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"1726d423-5198-4e54-adf2-bcdfa85882c7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"426869bc-0a6c-48fa-b5af-8fc88110c25b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"27f3492d-47e0-4288-abdd-330893c3fac3\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"576962a7-38c3-4b79-9b79-21aace807962\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"3f0206be-254e-46fc-b888-19c699916d4f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"6cbd3991-ed27-4385-b4ec-912c9b4bf63b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"74cc493d-f2fa-41ed-bd9f-51474f376322\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"93ca82f9-b3d0-4fe5-8e2e-76bb3bea3ebc\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"197d16a4-eb4e-445b-b441-7a74a2bf494a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"876cb960-7f73-4a2b-aaa9-15f1895198f2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"4d85a3e8-41f5-4247-b81f-d3f0c3b5fb2a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null}]\r\n\n```\nNo STDERR emitted by `ingest`.\n\n    "
      }
    },
    {
      "insertable": {
        "exec_identity": "ensureContent",
        "exec_code": "duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c302047e-21cf-5059-a32c-e81a9bd3a9b9', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NULL\n        OR TRIM(PAT_MRN_ID) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NOT NULL\n       AND PAT_MRN_ID NOT SIMILAR TO '^[+-]?[0-9]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Non-integer value \"' || invalid_value || '\" found in ' || issue_column,\n           'Convert non-integer values to INTEGER'\n      FROM numeric_value_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME IS NULL\n        OR TRIM(FIRST_NAME) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME NOT SIMILAR TO '%[A-Za-z]%'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern %[A-Za-z]%',\n           'Follow the pattern %[A-Za-z]% in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME IS NULL\n        OR TRIM(LAST_NAME) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME NOT SIMILAR TO '%[A-Za-z]%'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern %[A-Za-z]%',\n           'Follow the pattern %[A-Za-z]% in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_BIRTH_DATE IS NULL\n        OR TRIM(PAT_BIRTH_DATE) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE PAT_BIRTH_DATE IS NOT NULL\n    AND TRY_CAST(PAT_BIRTH_DATE AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(YEAR FROM PAT_BIRTH_DATE) >= 1915 \n      AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) <= EXTRACT(YEAR FROM CURRENT_DATE)\n      AND EXTRACT(MONTH FROM PAT_BIRTH_DATE) BETWEEN 1 AND 12\n      AND (\n         (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (1, 3, 5, 7, 8, 10, 12) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 31)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (4, 6, 9, 11) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 30)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2\n             AND (\n                (EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 4 = 0 AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 100 != 0)\n                OR EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 400 = 0\n             )\n             AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 29\n         )\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2 AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 28)\n      )\n   )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Birth Date \"' || invalid_value || '\" found in ' || issue_column,\n           'Is complete across all rows.  Date of Birth is numeric and follows YYYY-MM-DD.  YYYY is not before 1915  or after current date.  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 1916x every 4 years, DD is between 1 and 29.'\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NULL\n        OR TRIM(MEDICAID_CIN) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NOT NULL\n       AND MEDICAID_CIN NOT SIMILAR TO '^[+-]?[0-9]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Non-integer value \"' || invalid_value || '\" found in ' || issue_column,\n           'Convert non-integer values to INTEGER'\n      FROM numeric_value_in_all_rows; \nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_ID' AS issue_column,\n           ENCOUNTER_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ENCOUNTER_ID IS NULL\n        OR TRIM(ENCOUNTER_ID) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE RECORDED_TIME IS NULL\n        OR TRIM(RECORDED_TIME) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH valid_time_in_all_rows AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE RECORDED_TIME IS NOT NULL\n    AND TRY_CAST(RECORDED_TIME AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(year FROM RECORDED_TIME) >=  2023\n      AND EXTRACT(month FROM RECORDED_TIME) BETWEEN 1 AND 12\n      AND (\n          (EXTRACT(month FROM RECORDED_TIME) IN (01, 03, 05, 07, 08, 10, 12) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 31)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) IN (04, 06, 09, 11) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 30)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) = 02 AND (\n              (EXTRACT(year FROM RECORDED_TIME) % 4 = 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 29)\n              OR\n              (EXTRACT(year FROM RECORDED_TIME) % 4 != 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 27)\n          ))\n      )\n      AND EXTRACT(hour FROM RECORDED_TIME) BETWEEN 1 AND 24\n      AND EXTRACT(minute FROM RECORDED_TIME) BETWEEN 1 AND 59\n      AND EXTRACT(second FROM RECORDED_TIME) BETWEEN 1 AND 59\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid time \"' || invalid_value || '\" found in ' || issue_column,\n           'Year must be greater than 2023 and  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 2024x every 4 years, DD is between 1 and 29.  HH is between 1 and 24.  MM is between 1 and 59.  SS is between 1 and 59.'\n      FROM valid_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'QUESTION' AS issue_column,\n           QUESTION AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION IS NULL\n        OR TRIM(QUESTION) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'MEAS_VALUE' AS issue_column,\n           MEAS_VALUE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEAS_VALUE IS NULL\n        OR TRIM(MEAS_VALUE) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE IS NULL\n        OR TRIM(QUESTION_CODE) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE NOT IN (71802-3,96778-6)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (71802-3,96778-6)',\n           'Use only allowed values 71802-3,96778-6 in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE' AS issue_column,\n           ANSWER_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE IS NULL\n        OR TRIM(ANSWER_CODE) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           ANSWER_CODE_SYSTEM_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE_SYSTEM_NAME IS NULL\n        OR TRIM(ANSWER_CODE_SYSTEM_NAME) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'SDOH_DOMAIN' AS issue_column,\n           SDOH_DOMAIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SDOH_DOMAIN IS NULL\n        OR TRIM(SDOH_DOMAIN) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'NEED_INDICATED' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED IS NULL\n        OR TRIM(NEED_INDICATED) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'NEED_INDICATED' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (TRUE,FALSE)',\n           'Use only allowed values TRUE,FALSE in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG IS NULL\n        OR TRIM(VISIT_PART_2_FLAG) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (TRUE,FALSE)',\n           'Use only allowed values TRUE,FALSE in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG IS NULL\n        OR TRIM(VISIT_OMH_FLAG) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (TRUE,FALSE)',\n           'Use only allowed values TRUE,FALSE in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG IS NULL\n        OR TRIM(VISIT_OPWDD_FLAG) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (TRUE,FALSE)',\n           'Use only allowed values TRUE,FALSE in ' || issue_column\n      FROM allowed_values;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3252fee6-3a9a-5f4c-81c6-739201046d79', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    ",
        "orch_session_exec_id": "78d6a904-035e-54ae-8ac2-ca5cdf3f75f7",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c302047e-21cf-5059-a32c-e81a9bd3a9b9', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NULL\n        OR TRIM(PAT_MRN_ID) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NOT NULL\n       AND PAT_MRN_ID NOT SIMILAR TO '^[+-]?[0-9]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Non-integer value \"' || invalid_value || '\" found in ' || issue_column,\n           'Convert non-integer values to INTEGER'\n      FROM numeric_value_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME IS NULL\n        OR TRIM(FIRST_NAME) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME NOT SIMILAR TO '%[A-Za-z]%'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern %[A-Za-z]%',\n           'Follow the pattern %[A-Za-z]% in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME IS NULL\n        OR TRIM(LAST_NAME) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME NOT SIMILAR TO '%[A-Za-z]%'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern %[A-Za-z]%',\n           'Follow the pattern %[A-Za-z]% in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_BIRTH_DATE IS NULL\n        OR TRIM(PAT_BIRTH_DATE) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE PAT_BIRTH_DATE IS NOT NULL\n    AND TRY_CAST(PAT_BIRTH_DATE AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(YEAR FROM PAT_BIRTH_DATE) >= 1915 \n      AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) <= EXTRACT(YEAR FROM CURRENT_DATE)\n      AND EXTRACT(MONTH FROM PAT_BIRTH_DATE) BETWEEN 1 AND 12\n      AND (\n         (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (1, 3, 5, 7, 8, 10, 12) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 31)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (4, 6, 9, 11) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 30)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2\n             AND (\n                (EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 4 = 0 AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 100 != 0)\n                OR EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 400 = 0\n             )\n             AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 29\n         )\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2 AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 28)\n      )\n   )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Birth Date \"' || invalid_value || '\" found in ' || issue_column,\n           'Is complete across all rows.  Date of Birth is numeric and follows YYYY-MM-DD.  YYYY is not before 1915  or after current date.  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 1916x every 4 years, DD is between 1 and 29.'\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NULL\n        OR TRIM(MEDICAID_CIN) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NOT NULL\n       AND MEDICAID_CIN NOT SIMILAR TO '^[+-]?[0-9]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Non-integer value \"' || invalid_value || '\" found in ' || issue_column,\n           'Convert non-integer values to INTEGER'\n      FROM numeric_value_in_all_rows; \nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_ID' AS issue_column,\n           ENCOUNTER_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ENCOUNTER_ID IS NULL\n        OR TRIM(ENCOUNTER_ID) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE RECORDED_TIME IS NULL\n        OR TRIM(RECORDED_TIME) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH valid_time_in_all_rows AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE RECORDED_TIME IS NOT NULL\n    AND TRY_CAST(RECORDED_TIME AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(year FROM RECORDED_TIME) >=  2023\n      AND EXTRACT(month FROM RECORDED_TIME) BETWEEN 1 AND 12\n      AND (\n          (EXTRACT(month FROM RECORDED_TIME) IN (01, 03, 05, 07, 08, 10, 12) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 31)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) IN (04, 06, 09, 11) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 30)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) = 02 AND (\n              (EXTRACT(year FROM RECORDED_TIME) % 4 = 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 29)\n              OR\n              (EXTRACT(year FROM RECORDED_TIME) % 4 != 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 27)\n          ))\n      )\n      AND EXTRACT(hour FROM RECORDED_TIME) BETWEEN 1 AND 24\n      AND EXTRACT(minute FROM RECORDED_TIME) BETWEEN 1 AND 59\n      AND EXTRACT(second FROM RECORDED_TIME) BETWEEN 1 AND 59\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid time \"' || invalid_value || '\" found in ' || issue_column,\n           'Year must be greater than 2023 and  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 2024x every 4 years, DD is between 1 and 29.  HH is between 1 and 24.  MM is between 1 and 59.  SS is between 1 and 59.'\n      FROM valid_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'QUESTION' AS issue_column,\n           QUESTION AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION IS NULL\n        OR TRIM(QUESTION) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'MEAS_VALUE' AS issue_column,\n           MEAS_VALUE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEAS_VALUE IS NULL\n        OR TRIM(MEAS_VALUE) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE IS NULL\n        OR TRIM(QUESTION_CODE) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE NOT IN (71802-3,96778-6)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (71802-3,96778-6)',\n           'Use only allowed values 71802-3,96778-6 in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE' AS issue_column,\n           ANSWER_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE IS NULL\n        OR TRIM(ANSWER_CODE) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           ANSWER_CODE_SYSTEM_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE_SYSTEM_NAME IS NULL\n        OR TRIM(ANSWER_CODE_SYSTEM_NAME) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'SDOH_DOMAIN' AS issue_column,\n           SDOH_DOMAIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SDOH_DOMAIN IS NULL\n        OR TRIM(SDOH_DOMAIN) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'NEED_INDICATED' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED IS NULL\n        OR TRIM(NEED_INDICATED) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'NEED_INDICATED' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (TRUE,FALSE)',\n           'Use only allowed values TRUE,FALSE in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG IS NULL\n        OR TRIM(VISIT_PART_2_FLAG) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (TRUE,FALSE)',\n           'Use only allowed values TRUE,FALSE in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG IS NULL\n        OR TRIM(VISIT_OMH_FLAG) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (TRUE,FALSE)',\n           'Use only allowed values TRUE,FALSE in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG IS NULL\n        OR TRIM(VISIT_OPWDD_FLAG) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (TRUE,FALSE)',\n           'Use only allowed values TRUE,FALSE in ' || issue_column\n      FROM allowed_values;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3252fee6-3a9a-5f4c-81c6-739201046d79', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    ",
        "session_id": "05e8feaa-0bed-5909-a817-39812494b361",
        "narrative_md": "\n## ensureContent\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c302047e-21cf-5059-a32c-e81a9bd3a9b9', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NULL\n        OR TRIM(PAT_MRN_ID) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NOT NULL\n       AND PAT_MRN_ID NOT SIMILAR TO '^[+-]?[0-9]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Non-integer value \"' || invalid_value || '\" found in ' || issue_column,\n           'Convert non-integer values to INTEGER'\n      FROM numeric_value_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME IS NULL\n        OR TRIM(FIRST_NAME) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME NOT SIMILAR TO '%[A-Za-z]%'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern %[A-Za-z]%',\n           'Follow the pattern %[A-Za-z]% in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME IS NULL\n        OR TRIM(LAST_NAME) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME NOT SIMILAR TO '%[A-Za-z]%'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern %[A-Za-z]%',\n           'Follow the pattern %[A-Za-z]% in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_BIRTH_DATE IS NULL\n        OR TRIM(PAT_BIRTH_DATE) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE PAT_BIRTH_DATE IS NOT NULL\n    AND TRY_CAST(PAT_BIRTH_DATE AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(YEAR FROM PAT_BIRTH_DATE) >= 1915 \n      AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) <= EXTRACT(YEAR FROM CURRENT_DATE)\n      AND EXTRACT(MONTH FROM PAT_BIRTH_DATE) BETWEEN 1 AND 12\n      AND (\n         (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (1, 3, 5, 7, 8, 10, 12) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 31)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (4, 6, 9, 11) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 30)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2\n             AND (\n                (EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 4 = 0 AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 100 != 0)\n                OR EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 400 = 0\n             )\n             AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 29\n         )\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2 AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 28)\n      )\n   )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Birth Date \"' || invalid_value || '\" found in ' || issue_column,\n           'Is complete across all rows.  Date of Birth is numeric and follows YYYY-MM-DD.  YYYY is not before 1915  or after current date.  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 1916x every 4 years, DD is between 1 and 29.'\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NULL\n        OR TRIM(MEDICAID_CIN) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NOT NULL\n       AND MEDICAID_CIN NOT SIMILAR TO '^[+-]?[0-9]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Non-integer value \"' || invalid_value || '\" found in ' || issue_column,\n           'Convert non-integer values to INTEGER'\n      FROM numeric_value_in_all_rows; \nWITH mandatory_value AS (\n    SELECT 'ENCOUNTER_ID' AS issue_column,\n           ENCOUNTER_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ENCOUNTER_ID IS NULL\n        OR TRIM(ENCOUNTER_ID) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE RECORDED_TIME IS NULL\n        OR TRIM(RECORDED_TIME) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH valid_time_in_all_rows AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE RECORDED_TIME IS NOT NULL\n    AND TRY_CAST(RECORDED_TIME AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(year FROM RECORDED_TIME) >=  2023\n      AND EXTRACT(month FROM RECORDED_TIME) BETWEEN 1 AND 12\n      AND (\n          (EXTRACT(month FROM RECORDED_TIME) IN (01, 03, 05, 07, 08, 10, 12) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 31)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) IN (04, 06, 09, 11) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 30)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) = 02 AND (\n              (EXTRACT(year FROM RECORDED_TIME) % 4 = 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 29)\n              OR\n              (EXTRACT(year FROM RECORDED_TIME) % 4 != 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 27)\n          ))\n      )\n      AND EXTRACT(hour FROM RECORDED_TIME) BETWEEN 1 AND 24\n      AND EXTRACT(minute FROM RECORDED_TIME) BETWEEN 1 AND 59\n      AND EXTRACT(second FROM RECORDED_TIME) BETWEEN 1 AND 59\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid time \"' || invalid_value || '\" found in ' || issue_column,\n           'Year must be greater than 2023 and  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 2024x every 4 years, DD is between 1 and 29.  HH is between 1 and 24.  MM is between 1 and 59.  SS is between 1 and 59.'\n      FROM valid_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'QUESTION' AS issue_column,\n           QUESTION AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION IS NULL\n        OR TRIM(QUESTION) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'MEAS_VALUE' AS issue_column,\n           MEAS_VALUE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEAS_VALUE IS NULL\n        OR TRIM(MEAS_VALUE) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE IS NULL\n        OR TRIM(QUESTION_CODE) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE NOT IN (71802-3,96778-6)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (71802-3,96778-6)',\n           'Use only allowed values 71802-3,96778-6 in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE' AS issue_column,\n           ANSWER_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE IS NULL\n        OR TRIM(ANSWER_CODE) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           ANSWER_CODE_SYSTEM_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE_SYSTEM_NAME IS NULL\n        OR TRIM(ANSWER_CODE_SYSTEM_NAME) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'SDOH_DOMAIN' AS issue_column,\n           SDOH_DOMAIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SDOH_DOMAIN IS NULL\n        OR TRIM(SDOH_DOMAIN) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'NEED_INDICATED' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED IS NULL\n        OR TRIM(NEED_INDICATED) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'NEED_INDICATED' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (TRUE,FALSE)',\n           'Use only allowed values TRUE,FALSE in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG IS NULL\n        OR TRIM(VISIT_PART_2_FLAG) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (TRUE,FALSE)',\n           'Use only allowed values TRUE,FALSE in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG IS NULL\n        OR TRIM(VISIT_OMH_FLAG) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (TRUE,FALSE)',\n           'Use only allowed values TRUE,FALSE in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG IS NULL\n        OR TRIM(VISIT_OPWDD_FLAG) = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (TRUE,FALSE)',\n           'Use only allowed values TRUE,FALSE in ' || issue_column\n      FROM allowed_values;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3252fee6-3a9a-5f4c-81c6-739201046d79', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \n```\nNo STDOUT emitted by `ensureContent` (status: `0`).\n\nNo STDERR emitted by `ensureContent`.\n\n    "
      }
    },
    {
      "insertable": {
        "exec_identity": "emitResources",
        "exec_code": "duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8f460419-7b80-516d-8919-84520950f612', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7bab389e-54af-5a13-a39f-079abdc73a48', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1931dfcc-e8fc-597d-b1bc-65b4287e6fdf', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('fa7874f6-f848-572b-a9ab-9db4c8d5e959', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9860873a-c387-5d98-9930-4ff296eb7192', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\n\n-- diagnostics-md-ignore-start \"SQLPage and execution diagnostics SQL DML\"\n-- emit all the SQLPage content\nCREATE TABLE IF NOT EXISTS \"sqlpage_files\" (\n    \"path\" TEXT PRIMARY KEY NOT NULL,\n    \"contents\" TEXT NOT NULL,\n    \"last_modified\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/session_entries.handlebars', '<h1>{{title}}</h1>\n  \n<ul>\n{{#each_row}}\n    <li><a href=\"?session_entry_id={{orch_session_entry_id}}\">{{ingest_src}}</a> ({{ingest_table_name}})</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/info_model_schema_tables.handlebars', '{{caption}}\n<ul>\n{{#each_row}}\n    <li><a href=\"?table_nature={{nature}}&table_name={{table_name}}\">{{table_name}}</a> ({{nature}}, {{columns_count}} columns)</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('scripts/shell.js', 'function wrapSTDOUTInDetails() {\n    // Find all heading elements that could contain the STDOUT text\n    const headings = document.querySelectorAll(''h1, h2, h3, h4, h5, h6'');\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n            // Find the next <pre><code> block\n            var nextEl = heading.nextElementSibling;\n            while (nextEl) {\n                if (nextEl.matches(''pre'') && nextEl.querySelector(''code'')) {\n                    // Create the <details> and <summary> elements\n                    const details = document.createElement(''details'');\n                    const summary = document.createElement(''summary'');\n                    summary.textContent = heading.textContent;\n\n                    // Wrap the <pre><code> block in <details>\n                    nextEl.parentNode.insertBefore(details, nextEl);\n                    details.appendChild(summary);\n                    details.appendChild(nextEl);\n                    break;\n                }\n                nextEl = nextEl.nextElementSibling;\n            }\n        }\n    });\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n          heading.remove();\n        }\n    });\n}\n\ndocument.addEventListener(''DOMContentLoaded'', function() {\n  // find all code elements on the current page with the class ''language-sql'' and add the class ''line-numbers'' to each of them\n  document.querySelectorAll(''code.language-sql'').forEach(function(codeEl) {\n      var parentPre = codeEl.parentElement;\n      if (parentPre && parentPre.tagName === ''PRE'') {\n          parentPre.classList.add(''line-numbers'');\n      }\n  });\n  wrapSTDOUTInDetails();\n});\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('index.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''list'' as component;\nSELECT ''1115 Waiver Screenings'' as title,''1115-waiver-screenings.sql'' as link;\nSELECT ''Orchestration Sessions'' as title,''sessions.sql'' as link;\nSELECT ''Orchestration Issues'' as title,''issues.sql'' as link;\nSELECT ''Orchestration State Schema'' as title,''schema.sql'' as link;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sessions.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component;\nSELECT * FROM device;\n\nSELECT ''table'' as component, ''orch_session_id'' as markdown;\nSELECT ''['' || orch_session_id || ''](session-diagnostics.sql?session_id=''|| orch_session_id ||'')'' as orch_session_id, device_id, orch_started_at, orch_finished_at FROM orch_session;  \n\nSELECT ''table'' as component, ''true'' as search, ''ingest_src'' as markdown;\nSELECT ''['' || ingest_src || ''](issues.sql?session_entry_id=''|| orch_session_entry_id ||'')'' as ingest_src, ingest_table_name FROM \"orch_session_entry\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-diagnostics.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Arguments '') as title, (SELECT ''```json\n'' || args_json || ''\n```'' FROM orch_session WHERE orch_session_id = $session_id) as contents_md;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Diagnostics '') as title, (SELECT diagnostics_md FROM orch_session WHERE orch_session_id = $session_id) as contents_md;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('issues.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''session_entries'' as component, ''Choose Session Entry'' as title;\nSELECT orch_session_entry_id, ingest_src, ingest_table_name \n  FROM orch_session_entry;\n\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT issue_type, issue_message, invalid_value, remediation\n              FROM orch_session_issue\n             WHERE session_entry_id = $session_entry_id;\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('1115-waiver-screenings.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort, ''pat_mrn_id'' as markdown;\n\n              SELECT format(''[%s](?pat_mrn_id=%s)'', pat_mrn_id, pat_mrn_id) as pat_mrn_id, facility, first_name, last_name\n                FROM ahc_hrsn_12_12_2023_valid\n            GROUP BY pat_mrn_id, facility, first_name, last_name\n            ORDER BY facility, last_name, first_name;\n\nSELECT ''text'' as component, (select format(''%s %s Answers'', first_name, last_name) from ahc_hrsn_12_12_2023_valid where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE coalesce($pat_mrn_id, '''') <> '''';\n\n            SELECT question, meas_value \n              FROM \"ahc_hrsn_12_12_2023_valid\"\n             WHERE pat_mrn_id = $pat_mrn_id;\n\nSELECT ''text'' as component, (select format(''%s %s FHIR Observations'', first_name, last_name) from ahc_hrsn_12_12_2023_valid where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT * \n              FROM \"ahc_hrsn_12_12_2023_valid_fhir\"\n             WHERE pat_mrn_id = $pat_mrn_id;\n\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('schema.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Information Model (Schema) Documentation'' as title, ''TODO (description)'' as contents_md;\n\nSELECT ''table'' as component, ''table_name'' as markdown;\n\n          SELECT format(''[%s](?table_name=%s&table_nature)'', m.tbl_name, m.tbl_name, m.type) AS table_name,\n                 (SELECT COUNT(*) FROM sqlite_master sm2 JOIN pragma_table_info(m.tbl_name) cc ON 1=1 WHERE sm2.tbl_name = m.tbl_name) AS columns_count,\n                 m.type as nature\n            FROM sqlite_master m\n        ORDER BY table_name\n      ;\n\nSELECT ''text'' as component, ($table_name || '' '' || $table_nature || '' columns'' ) as title, ''TODO (lineage, governance, description, etc.)'' as contents_md WHERE coalesce($table_name, '''') <> '''';\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT\n              ROW_NUMBER() OVER (PARTITION BY m.tbl_name ORDER BY c.cid) AS column_num,\n              -- TODO: add governance information (e.g. description, etc. from SQLa)\n              CASE WHEN c.pk THEN ''*'' ELSE '''' END AS is_primary_key,\n              c.name AS column_name,\n              c.\"type\" AS column_type,\n              CASE WHEN c.\"notnull\" THEN ''*'' ELSE '''' END AS not_null,\n              COALESCE(c.dflt_value, '''') AS default_value,\n              COALESCE((SELECT pfkl.\"table\" || ''.'' || pfkl.\"to\" FROM pragma_foreign_key_list(m.tbl_name) AS pfkl WHERE pfkl.\"from\" = c.name), '''') as fk_refs\n              -- TODO: add \"is_indexed\" and other details\n            FROM sqlite_master m JOIN pragma_table_info(m.tbl_name) c ON 1=1\n            WHERE m.tbl_name = $table_name;\n\nSELECT ''text'' as component, ($table_name || '' indexes'') as title;\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT il.name as \"Index Name\", group_concat(ii.name, '', '') as columns\n              FROM sqlite_master as m, pragma_index_list(m.name) AS il, pragma_index_info(il.name) AS ii\n             WHERE m.tbl_name = $table_name\n             GROUP BY m.name, il.name;\n\n-- TODO: add PlantUML or Mermaid ERD through SQL as emitted by tbls (use ChatGPT to create)\n    ;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;;\n\n-- emit all the execution diagnostics\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('168a34c7-d043-5ec4-a84a-c961f1a301ef', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'init', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''Shaju'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"windows\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''05e8feaa-0bed-5909-a817-39812494b361'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', (make_timestamp(2024, 1, 3, 14, 30, 25.781)), NULL, NULL, NULL, NULL, ''Session 05e8feaa-0bed-5909-a817-39812494b361 markdown diagnostics not provided (not completed?)'');\n\n-- no after-init SQL found', NULL, NULL, NULL, '\n## init\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''Shaju'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"windows\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''05e8feaa-0bed-5909-a817-39812494b361'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', (make_timestamp(2024, 1, 3, 14, 30, 25.781)), NULL, NULL, NULL, NULL, ''Session 05e8feaa-0bed-5909-a817-39812494b361 markdown diagnostics not provided (not completed?)'');\n\n-- no after-init SQL found\n```\nNo STDOUT emitted by `init` (status: `0`).\n\nNo STDERR emitted by `init`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('5222b730-9add-5b52-b0c9-6f2506b0af9d', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'ingest', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb --json', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv'', ''ahc_hrsn_12_12_2023_valid'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''NONE'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'' as session_entry_id\n    FROM read_csv_auto(''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_12_12_2023_valid'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_12_12_2023_valid.'',\n           ''Ensure ahc_hrsn_12_12_2023_valid contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_admin_demographic'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''Admin_Demographic'''' has not been implemented yet.'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_screening'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''47277588-99e8-59f5-8384-b24344a86073'', ''NONE'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''47277588-99e8-59f5-8384-b24344a86073'' as session_entry_id\n    FROM st_read(''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_valid_01_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_valid_01_screening.'',\n           ''Ensure ahc_hrsn_valid_01_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''47277588-99e8-59f5-8384-b24344a86073'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_q_e_admin_data'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''QE_Admin_Data'''' has not been implemented yet.'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''591191c7-f693-5957-8734-ac87151ca981'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''86b4a49e-7378-5159-9f41-b005208c31bc'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''86b4a49e-7378-5159-9f41-b005208c31bc'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv'', ''synthetic_fail'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''NONE'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''c60cf3db-b1bf-5103-b278-b0c128ce924a'' as session_entry_id\n    FROM read_csv_auto(''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''synthetic_fail'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''c60cf3db-b1bf-5103-b278-b0c128ce924a'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in synthetic_fail.'',\n           ''Ensure synthetic_fail contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b10e248d-8c94-59ec-83fc-a1249dd3b111'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05e8feaa-0bed-5909-a817-39812494b361''', NULL, '[{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\ahc-hrsn-valid-01.xlsx\"},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"58821d95-8a89-47f3-af13-7be681531d40\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"9dd3301c-464b-43fa-89c4-97d79e57b86f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"9fef81b3-cd5d-4447-ae1d-9421207a3ded\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"020c16c7-b208-4bb9-8f2e-c4b64db30561\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"5d3e9ae5-a603-42b6-aac6-c29f27c9f086\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"dcf02031-a395-4b9c-a3dc-6c038f6d0e3e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"cfee50d5-6b5c-4526-b783-e1d60a7676bc\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"24c3f824-9559-4ea8-b5b3-be31fc6ba704\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"366661bc-9ace-480e-a598-e389647c8384\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"028364d1-8b23-4892-94ad-91e83a9101c2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"146e26dc-7378-4fff-8fd5-78cab94ae3cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"6c28fd55-b2ac-49c2-8874-8162a42dd784\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\ahc-hrsn-valid-01.xlsx\"},\r\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49\",\"orch_session_issue_id\":\"591191c7-f693-5957-8734-ac87151ca981\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"3b4eb0e5-6239-537a-8e67-e50e172e72a2\",\"orch_session_issue_id\":\"071f8fe1-4899-5c71-9c86-7d7377661d45\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"86b4a49e-7378-5159-9f41-b005208c31bc\",\"orch_session_issue_id\":\"a530fe1b-57ef-5a90-8bea-835ece2483da\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"a3fe7098-8ae8-5612-81ac-cbe10780c19b\",\"orch_session_issue_id\":\"99e72a60-96ab-5ef1-a3af-3e7759777664\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"e36daa69-3c63-5384-b6a7-03fa3b00641d\",\"orch_session_issue_id\":\"89f7ec04-277a-5799-afaa-a70d0f2a8ed5\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"72107c98-a89b-44c0-985e-6fe19502d326\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"262b3ee4-4854-410b-989d-94297e82fa57\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"d646b6eb-9067-40a5-bdca-0efb462c3706\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"863cb049-64d6-4ef4-a176-79222f4e6ddf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"09f5833f-732a-41b4-821a-63cf311d68cd\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"91b545b8-899e-4ea8-ba07-be3d09c8a27a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"ee83a333-4eba-4acc-98be-618a58903e1a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"f9a27b22-f294-40cf-8f07-a3ca9409fbc5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"4dbeba36-21b5-42e2-91e8-e9e3ebc493b1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"ab0a8a0c-476c-42c1-888d-d85a475c4762\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"1726d423-5198-4e54-adf2-bcdfa85882c7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"426869bc-0a6c-48fa-b5af-8fc88110c25b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"27f3492d-47e0-4288-abdd-330893c3fac3\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"576962a7-38c3-4b79-9b79-21aace807962\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"3f0206be-254e-46fc-b888-19c699916d4f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"6cbd3991-ed27-4385-b4ec-912c9b4bf63b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"74cc493d-f2fa-41ed-bd9f-51474f376322\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"93ca82f9-b3d0-4fe5-8e2e-76bb3bea3ebc\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"197d16a4-eb4e-445b-b441-7a74a2bf494a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"876cb960-7f73-4a2b-aaa9-15f1895198f2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"4d85a3e8-41f5-4247-b81f-d3f0c3b5fb2a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null}]\r\n', 'JSON', '\n## ingest\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv'', ''ahc_hrsn_12_12_2023_valid'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''NONE'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'' as session_entry_id\n    FROM read_csv_auto(''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_12_12_2023_valid'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_12_12_2023_valid.'',\n           ''Ensure ahc_hrsn_12_12_2023_valid contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_admin_demographic'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''Admin_Demographic'''' has not been implemented yet.'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_screening'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''47277588-99e8-59f5-8384-b24344a86073'', ''NONE'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''47277588-99e8-59f5-8384-b24344a86073'' as session_entry_id\n    FROM st_read(''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_valid_01_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_valid_01_screening.'',\n           ''Ensure ahc_hrsn_valid_01_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''47277588-99e8-59f5-8384-b24344a86073'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_q_e_admin_data'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''QE_Admin_Data'''' has not been implemented yet.'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''591191c7-f693-5957-8734-ac87151ca981'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''86b4a49e-7378-5159-9f41-b005208c31bc'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''86b4a49e-7378-5159-9f41-b005208c31bc'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv'', ''synthetic_fail'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''NONE'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''c60cf3db-b1bf-5103-b278-b0c128ce924a'' as session_entry_id\n    FROM read_csv_auto(''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''synthetic_fail'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''c60cf3db-b1bf-5103-b278-b0c128ce924a'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in synthetic_fail.'',\n           ''Ensure synthetic_fail contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b10e248d-8c94-59ec-83fc-a1249dd3b111'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05e8feaa-0bed-5909-a817-39812494b361''\n```\n### `ingest` STDOUT (status: `0`)\n```json\n[{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\ahc-hrsn-valid-01.xlsx\"},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"58821d95-8a89-47f3-af13-7be681531d40\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"9dd3301c-464b-43fa-89c4-97d79e57b86f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"9fef81b3-cd5d-4447-ae1d-9421207a3ded\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"020c16c7-b208-4bb9-8f2e-c4b64db30561\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"5d3e9ae5-a603-42b6-aac6-c29f27c9f086\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"dcf02031-a395-4b9c-a3dc-6c038f6d0e3e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"cfee50d5-6b5c-4526-b783-e1d60a7676bc\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"24c3f824-9559-4ea8-b5b3-be31fc6ba704\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"366661bc-9ace-480e-a598-e389647c8384\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"028364d1-8b23-4892-94ad-91e83a9101c2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"146e26dc-7378-4fff-8fd5-78cab94ae3cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"6c28fd55-b2ac-49c2-8874-8162a42dd784\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\ahc-hrsn-valid-01.xlsx\"},\r\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49\",\"orch_session_issue_id\":\"591191c7-f693-5957-8734-ac87151ca981\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"3b4eb0e5-6239-537a-8e67-e50e172e72a2\",\"orch_session_issue_id\":\"071f8fe1-4899-5c71-9c86-7d7377661d45\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"86b4a49e-7378-5159-9f41-b005208c31bc\",\"orch_session_issue_id\":\"a530fe1b-57ef-5a90-8bea-835ece2483da\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"a3fe7098-8ae8-5612-81ac-cbe10780c19b\",\"orch_session_issue_id\":\"99e72a60-96ab-5ef1-a3af-3e7759777664\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"e36daa69-3c63-5384-b6a7-03fa3b00641d\",\"orch_session_issue_id\":\"89f7ec04-277a-5799-afaa-a70d0f2a8ed5\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"72107c98-a89b-44c0-985e-6fe19502d326\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"262b3ee4-4854-410b-989d-94297e82fa57\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"d646b6eb-9067-40a5-bdca-0efb462c3706\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"863cb049-64d6-4ef4-a176-79222f4e6ddf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"09f5833f-732a-41b4-821a-63cf311d68cd\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"91b545b8-899e-4ea8-ba07-be3d09c8a27a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"ee83a333-4eba-4acc-98be-618a58903e1a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"f9a27b22-f294-40cf-8f07-a3ca9409fbc5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"4dbeba36-21b5-42e2-91e8-e9e3ebc493b1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"ab0a8a0c-476c-42c1-888d-d85a475c4762\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"1726d423-5198-4e54-adf2-bcdfa85882c7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"426869bc-0a6c-48fa-b5af-8fc88110c25b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"27f3492d-47e0-4288-abdd-330893c3fac3\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"576962a7-38c3-4b79-9b79-21aace807962\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"3f0206be-254e-46fc-b888-19c699916d4f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"6cbd3991-ed27-4385-b4ec-912c9b4bf63b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"74cc493d-f2fa-41ed-bd9f-51474f376322\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"93ca82f9-b3d0-4fe5-8e2e-76bb3bea3ebc\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"197d16a4-eb4e-445b-b441-7a74a2bf494a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"876cb960-7f73-4a2b-aaa9-15f1895198f2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"4d85a3e8-41f5-4247-b81f-d3f0c3b5fb2a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null}]\r\n\n```\nNo STDERR emitted by `ingest`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'ensureContent', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NULL\n        OR TRIM(PAT_MRN_ID) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NOT NULL\n       AND PAT_MRN_ID NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME IS NULL\n        OR TRIM(FIRST_NAME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME NOT SIMILAR TO ''%[A-Za-z]%''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern %[A-Za-z]%'',\n           ''Follow the pattern %[A-Za-z]% in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME IS NULL\n        OR TRIM(LAST_NAME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME NOT SIMILAR TO ''%[A-Za-z]%''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern %[A-Za-z]%'',\n           ''Follow the pattern %[A-Za-z]% in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_BIRTH_DATE IS NULL\n        OR TRIM(PAT_BIRTH_DATE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE PAT_BIRTH_DATE IS NOT NULL\n    AND TRY_CAST(PAT_BIRTH_DATE AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(YEAR FROM PAT_BIRTH_DATE) >= 1915 \n      AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) <= EXTRACT(YEAR FROM CURRENT_DATE)\n      AND EXTRACT(MONTH FROM PAT_BIRTH_DATE) BETWEEN 1 AND 12\n      AND (\n         (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (1, 3, 5, 7, 8, 10, 12) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 31)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (4, 6, 9, 11) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 30)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2\n             AND (\n                (EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 4 = 0 AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 100 != 0)\n                OR EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 400 = 0\n             )\n             AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 29\n         )\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2 AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 28)\n      )\n   )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Birth Date \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Is complete across all rows.  Date of Birth is numeric and follows YYYY-MM-DD.  YYYY is not before 1915  or after current date.  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 1916x every 4 years, DD is between 1 and 29.''\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NULL\n        OR TRIM(MEDICAID_CIN) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NOT NULL\n       AND MEDICAID_CIN NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows; \nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_ID'' AS issue_column,\n           ENCOUNTER_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ENCOUNTER_ID IS NULL\n        OR TRIM(ENCOUNTER_ID) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE RECORDED_TIME IS NULL\n        OR TRIM(RECORDED_TIME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH valid_time_in_all_rows AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE RECORDED_TIME IS NOT NULL\n    AND TRY_CAST(RECORDED_TIME AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(year FROM RECORDED_TIME) >=  2023\n      AND EXTRACT(month FROM RECORDED_TIME) BETWEEN 1 AND 12\n      AND (\n          (EXTRACT(month FROM RECORDED_TIME) IN (01, 03, 05, 07, 08, 10, 12) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 31)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) IN (04, 06, 09, 11) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 30)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) = 02 AND (\n              (EXTRACT(year FROM RECORDED_TIME) % 4 = 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 29)\n              OR\n              (EXTRACT(year FROM RECORDED_TIME) % 4 != 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 27)\n          ))\n      )\n      AND EXTRACT(hour FROM RECORDED_TIME) BETWEEN 1 AND 24\n      AND EXTRACT(minute FROM RECORDED_TIME) BETWEEN 1 AND 59\n      AND EXTRACT(second FROM RECORDED_TIME) BETWEEN 1 AND 59\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid time \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Year must be greater than 2023 and  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 2024x every 4 years, DD is between 1 and 29.  HH is between 1 and 24.  MM is between 1 and 59.  SS is between 1 and 59.''\n      FROM valid_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION'' AS issue_column,\n           QUESTION AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION IS NULL\n        OR TRIM(QUESTION) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''MEAS_VALUE'' AS issue_column,\n           MEAS_VALUE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEAS_VALUE IS NULL\n        OR TRIM(MEAS_VALUE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE IS NULL\n        OR TRIM(QUESTION_CODE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE NOT IN (71802-3,96778-6)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (71802-3,96778-6)'',\n           ''Use only allowed values 71802-3,96778-6 in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE'' AS issue_column,\n           ANSWER_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE IS NULL\n        OR TRIM(ANSWER_CODE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           ANSWER_CODE_SYSTEM_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE_SYSTEM_NAME IS NULL\n        OR TRIM(ANSWER_CODE_SYSTEM_NAME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           SDOH_DOMAIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SDOH_DOMAIN IS NULL\n        OR TRIM(SDOH_DOMAIN) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''NEED_INDICATED'' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED IS NULL\n        OR TRIM(NEED_INDICATED) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''NEED_INDICATED'' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG IS NULL\n        OR TRIM(VISIT_PART_2_FLAG) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG IS NULL\n        OR TRIM(VISIT_OMH_FLAG) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG IS NULL\n        OR TRIM(VISIT_OPWDD_FLAG) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3252fee6-3a9a-5f4c-81c6-739201046d79'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    ', NULL, NULL, NULL, '\n## ensureContent\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NULL\n        OR TRIM(PAT_MRN_ID) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NOT NULL\n       AND PAT_MRN_ID NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME IS NULL\n        OR TRIM(FIRST_NAME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME NOT SIMILAR TO ''%[A-Za-z]%''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern %[A-Za-z]%'',\n           ''Follow the pattern %[A-Za-z]% in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME IS NULL\n        OR TRIM(LAST_NAME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME NOT SIMILAR TO ''%[A-Za-z]%''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern %[A-Za-z]%'',\n           ''Follow the pattern %[A-Za-z]% in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_BIRTH_DATE IS NULL\n        OR TRIM(PAT_BIRTH_DATE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE PAT_BIRTH_DATE IS NOT NULL\n    AND TRY_CAST(PAT_BIRTH_DATE AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(YEAR FROM PAT_BIRTH_DATE) >= 1915 \n      AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) <= EXTRACT(YEAR FROM CURRENT_DATE)\n      AND EXTRACT(MONTH FROM PAT_BIRTH_DATE) BETWEEN 1 AND 12\n      AND (\n         (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (1, 3, 5, 7, 8, 10, 12) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 31)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (4, 6, 9, 11) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 30)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2\n             AND (\n                (EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 4 = 0 AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 100 != 0)\n                OR EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 400 = 0\n             )\n             AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 29\n         )\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2 AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 28)\n      )\n   )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Birth Date \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Is complete across all rows.  Date of Birth is numeric and follows YYYY-MM-DD.  YYYY is not before 1915  or after current date.  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 1916x every 4 years, DD is between 1 and 29.''\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NULL\n        OR TRIM(MEDICAID_CIN) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NOT NULL\n       AND MEDICAID_CIN NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows; \nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_ID'' AS issue_column,\n           ENCOUNTER_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ENCOUNTER_ID IS NULL\n        OR TRIM(ENCOUNTER_ID) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE RECORDED_TIME IS NULL\n        OR TRIM(RECORDED_TIME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH valid_time_in_all_rows AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE RECORDED_TIME IS NOT NULL\n    AND TRY_CAST(RECORDED_TIME AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(year FROM RECORDED_TIME) >=  2023\n      AND EXTRACT(month FROM RECORDED_TIME) BETWEEN 1 AND 12\n      AND (\n          (EXTRACT(month FROM RECORDED_TIME) IN (01, 03, 05, 07, 08, 10, 12) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 31)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) IN (04, 06, 09, 11) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 30)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) = 02 AND (\n              (EXTRACT(year FROM RECORDED_TIME) % 4 = 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 29)\n              OR\n              (EXTRACT(year FROM RECORDED_TIME) % 4 != 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 27)\n          ))\n      )\n      AND EXTRACT(hour FROM RECORDED_TIME) BETWEEN 1 AND 24\n      AND EXTRACT(minute FROM RECORDED_TIME) BETWEEN 1 AND 59\n      AND EXTRACT(second FROM RECORDED_TIME) BETWEEN 1 AND 59\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid time \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Year must be greater than 2023 and  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 2024x every 4 years, DD is between 1 and 29.  HH is between 1 and 24.  MM is between 1 and 59.  SS is between 1 and 59.''\n      FROM valid_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION'' AS issue_column,\n           QUESTION AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION IS NULL\n        OR TRIM(QUESTION) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''MEAS_VALUE'' AS issue_column,\n           MEAS_VALUE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEAS_VALUE IS NULL\n        OR TRIM(MEAS_VALUE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE IS NULL\n        OR TRIM(QUESTION_CODE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE NOT IN (71802-3,96778-6)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (71802-3,96778-6)'',\n           ''Use only allowed values 71802-3,96778-6 in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE'' AS issue_column,\n           ANSWER_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE IS NULL\n        OR TRIM(ANSWER_CODE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           ANSWER_CODE_SYSTEM_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE_SYSTEM_NAME IS NULL\n        OR TRIM(ANSWER_CODE_SYSTEM_NAME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           SDOH_DOMAIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SDOH_DOMAIN IS NULL\n        OR TRIM(SDOH_DOMAIN) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''NEED_INDICATED'' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED IS NULL\n        OR TRIM(NEED_INDICATED) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''NEED_INDICATED'' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG IS NULL\n        OR TRIM(VISIT_PART_2_FLAG) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG IS NULL\n        OR TRIM(VISIT_OMH_FLAG) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG IS NULL\n        OR TRIM(VISIT_OPWDD_FLAG) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3252fee6-3a9a-5f4c-81c6-739201046d79'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n```\nNo STDOUT emitted by `ensureContent` (status: `0`).\n\nNo STDERR emitted by `ensureContent`.\n\n    ', NULL);;\n-- diagnostics-md-ignore-finish \"SQLPage and execution diagnostics SQL DML\"\n\nATTACH 'support/assurance/ahc-hrsn-elt/screening/results-test-e2e/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n-- copy relevant orchestration engine admin tables into the the attached database\nCREATE TABLE resource_db.device AS SELECT * FROM device;\nCREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\nCREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\nCREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\nCREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\nCREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\nCREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n-- export content tables from DuckDb into the attached database (nature-dependent)\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ASSURED_CSV', 'ATTEMPT_CSV_EXPORT', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\nCREATE TABLE resource_db.ahc_hrsn_12_12_2023_valid AS SELECT * FROM ahc_hrsn_12_12_2023_valid;\n\nCREATE VIEW resource_db.ahc_hrsn_12_12_2023_valid_fhir AS \n  SELECT pat_mrn_id, json_object(\n        'resourceType', 'Observation',\n        'id', ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', QUESTION_CODE_SYSTEM_NAME,\n                    'code', QUESTION_CODE,\n                    'display', QUESTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID\n        ),\n        'effectiveDateTime', RECORDED_TIME,\n        'valueString', MEAS_VALUE,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM ahc_hrsn_12_12_2023_valid;\n  \n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('46171763-bd21-57a8-a403-0785f72643cf', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_EXPORT', 'CSV_EXPORTED', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  ;\n\nDETACH DATABASE resource_db;\n\n-- no after-finalize SQL provided",
        "orch_session_exec_id": "4971a2f5-06a3-5898-823d-364145d3b9a5",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8f460419-7b80-516d-8919-84520950f612', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7bab389e-54af-5a13-a39f-079abdc73a48', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1931dfcc-e8fc-597d-b1bc-65b4287e6fdf', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('fa7874f6-f848-572b-a9ab-9db4c8d5e959', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9860873a-c387-5d98-9930-4ff296eb7192', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\n\n-- diagnostics-md-ignore-start \"SQLPage and execution diagnostics SQL DML\"\n-- emit all the SQLPage content\nCREATE TABLE IF NOT EXISTS \"sqlpage_files\" (\n    \"path\" TEXT PRIMARY KEY NOT NULL,\n    \"contents\" TEXT NOT NULL,\n    \"last_modified\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/session_entries.handlebars', '<h1>{{title}}</h1>\n  \n<ul>\n{{#each_row}}\n    <li><a href=\"?session_entry_id={{orch_session_entry_id}}\">{{ingest_src}}</a> ({{ingest_table_name}})</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/info_model_schema_tables.handlebars', '{{caption}}\n<ul>\n{{#each_row}}\n    <li><a href=\"?table_nature={{nature}}&table_name={{table_name}}\">{{table_name}}</a> ({{nature}}, {{columns_count}} columns)</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('scripts/shell.js', 'function wrapSTDOUTInDetails() {\n    // Find all heading elements that could contain the STDOUT text\n    const headings = document.querySelectorAll(''h1, h2, h3, h4, h5, h6'');\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n            // Find the next <pre><code> block\n            var nextEl = heading.nextElementSibling;\n            while (nextEl) {\n                if (nextEl.matches(''pre'') && nextEl.querySelector(''code'')) {\n                    // Create the <details> and <summary> elements\n                    const details = document.createElement(''details'');\n                    const summary = document.createElement(''summary'');\n                    summary.textContent = heading.textContent;\n\n                    // Wrap the <pre><code> block in <details>\n                    nextEl.parentNode.insertBefore(details, nextEl);\n                    details.appendChild(summary);\n                    details.appendChild(nextEl);\n                    break;\n                }\n                nextEl = nextEl.nextElementSibling;\n            }\n        }\n    });\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n          heading.remove();\n        }\n    });\n}\n\ndocument.addEventListener(''DOMContentLoaded'', function() {\n  // find all code elements on the current page with the class ''language-sql'' and add the class ''line-numbers'' to each of them\n  document.querySelectorAll(''code.language-sql'').forEach(function(codeEl) {\n      var parentPre = codeEl.parentElement;\n      if (parentPre && parentPre.tagName === ''PRE'') {\n          parentPre.classList.add(''line-numbers'');\n      }\n  });\n  wrapSTDOUTInDetails();\n});\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('index.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''list'' as component;\nSELECT ''1115 Waiver Screenings'' as title,''1115-waiver-screenings.sql'' as link;\nSELECT ''Orchestration Sessions'' as title,''sessions.sql'' as link;\nSELECT ''Orchestration Issues'' as title,''issues.sql'' as link;\nSELECT ''Orchestration State Schema'' as title,''schema.sql'' as link;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sessions.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component;\nSELECT * FROM device;\n\nSELECT ''table'' as component, ''orch_session_id'' as markdown;\nSELECT ''['' || orch_session_id || ''](session-diagnostics.sql?session_id=''|| orch_session_id ||'')'' as orch_session_id, device_id, orch_started_at, orch_finished_at FROM orch_session;  \n\nSELECT ''table'' as component, ''true'' as search, ''ingest_src'' as markdown;\nSELECT ''['' || ingest_src || ''](issues.sql?session_entry_id=''|| orch_session_entry_id ||'')'' as ingest_src, ingest_table_name FROM \"orch_session_entry\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-diagnostics.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Arguments '') as title, (SELECT ''```json\n'' || args_json || ''\n```'' FROM orch_session WHERE orch_session_id = $session_id) as contents_md;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Diagnostics '') as title, (SELECT diagnostics_md FROM orch_session WHERE orch_session_id = $session_id) as contents_md;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('issues.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''session_entries'' as component, ''Choose Session Entry'' as title;\nSELECT orch_session_entry_id, ingest_src, ingest_table_name \n  FROM orch_session_entry;\n\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT issue_type, issue_message, invalid_value, remediation\n              FROM orch_session_issue\n             WHERE session_entry_id = $session_entry_id;\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('1115-waiver-screenings.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort, ''pat_mrn_id'' as markdown;\n\n              SELECT format(''[%s](?pat_mrn_id=%s)'', pat_mrn_id, pat_mrn_id) as pat_mrn_id, facility, first_name, last_name\n                FROM ahc_hrsn_12_12_2023_valid\n            GROUP BY pat_mrn_id, facility, first_name, last_name\n            ORDER BY facility, last_name, first_name;\n\nSELECT ''text'' as component, (select format(''%s %s Answers'', first_name, last_name) from ahc_hrsn_12_12_2023_valid where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE coalesce($pat_mrn_id, '''') <> '''';\n\n            SELECT question, meas_value \n              FROM \"ahc_hrsn_12_12_2023_valid\"\n             WHERE pat_mrn_id = $pat_mrn_id;\n\nSELECT ''text'' as component, (select format(''%s %s FHIR Observations'', first_name, last_name) from ahc_hrsn_12_12_2023_valid where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT * \n              FROM \"ahc_hrsn_12_12_2023_valid_fhir\"\n             WHERE pat_mrn_id = $pat_mrn_id;\n\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('schema.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Information Model (Schema) Documentation'' as title, ''TODO (description)'' as contents_md;\n\nSELECT ''table'' as component, ''table_name'' as markdown;\n\n          SELECT format(''[%s](?table_name=%s&table_nature)'', m.tbl_name, m.tbl_name, m.type) AS table_name,\n                 (SELECT COUNT(*) FROM sqlite_master sm2 JOIN pragma_table_info(m.tbl_name) cc ON 1=1 WHERE sm2.tbl_name = m.tbl_name) AS columns_count,\n                 m.type as nature\n            FROM sqlite_master m\n        ORDER BY table_name\n      ;\n\nSELECT ''text'' as component, ($table_name || '' '' || $table_nature || '' columns'' ) as title, ''TODO (lineage, governance, description, etc.)'' as contents_md WHERE coalesce($table_name, '''') <> '''';\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT\n              ROW_NUMBER() OVER (PARTITION BY m.tbl_name ORDER BY c.cid) AS column_num,\n              -- TODO: add governance information (e.g. description, etc. from SQLa)\n              CASE WHEN c.pk THEN ''*'' ELSE '''' END AS is_primary_key,\n              c.name AS column_name,\n              c.\"type\" AS column_type,\n              CASE WHEN c.\"notnull\" THEN ''*'' ELSE '''' END AS not_null,\n              COALESCE(c.dflt_value, '''') AS default_value,\n              COALESCE((SELECT pfkl.\"table\" || ''.'' || pfkl.\"to\" FROM pragma_foreign_key_list(m.tbl_name) AS pfkl WHERE pfkl.\"from\" = c.name), '''') as fk_refs\n              -- TODO: add \"is_indexed\" and other details\n            FROM sqlite_master m JOIN pragma_table_info(m.tbl_name) c ON 1=1\n            WHERE m.tbl_name = $table_name;\n\nSELECT ''text'' as component, ($table_name || '' indexes'') as title;\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT il.name as \"Index Name\", group_concat(ii.name, '', '') as columns\n              FROM sqlite_master as m, pragma_index_list(m.name) AS il, pragma_index_info(il.name) AS ii\n             WHERE m.tbl_name = $table_name\n             GROUP BY m.name, il.name;\n\n-- TODO: add PlantUML or Mermaid ERD through SQL as emitted by tbls (use ChatGPT to create)\n    ;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;;\n\n-- emit all the execution diagnostics\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('168a34c7-d043-5ec4-a84a-c961f1a301ef', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'init', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''Shaju'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"windows\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''05e8feaa-0bed-5909-a817-39812494b361'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', (make_timestamp(2024, 1, 3, 14, 30, 25.781)), NULL, NULL, NULL, NULL, ''Session 05e8feaa-0bed-5909-a817-39812494b361 markdown diagnostics not provided (not completed?)'');\n\n-- no after-init SQL found', NULL, NULL, NULL, '\n## init\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''Shaju'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"windows\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''05e8feaa-0bed-5909-a817-39812494b361'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', (make_timestamp(2024, 1, 3, 14, 30, 25.781)), NULL, NULL, NULL, NULL, ''Session 05e8feaa-0bed-5909-a817-39812494b361 markdown diagnostics not provided (not completed?)'');\n\n-- no after-init SQL found\n```\nNo STDOUT emitted by `init` (status: `0`).\n\nNo STDERR emitted by `init`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('5222b730-9add-5b52-b0c9-6f2506b0af9d', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'ingest', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb --json', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv'', ''ahc_hrsn_12_12_2023_valid'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''NONE'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'' as session_entry_id\n    FROM read_csv_auto(''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_12_12_2023_valid'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_12_12_2023_valid.'',\n           ''Ensure ahc_hrsn_12_12_2023_valid contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_admin_demographic'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''Admin_Demographic'''' has not been implemented yet.'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_screening'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''47277588-99e8-59f5-8384-b24344a86073'', ''NONE'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''47277588-99e8-59f5-8384-b24344a86073'' as session_entry_id\n    FROM st_read(''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_valid_01_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_valid_01_screening.'',\n           ''Ensure ahc_hrsn_valid_01_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''47277588-99e8-59f5-8384-b24344a86073'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_q_e_admin_data'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''QE_Admin_Data'''' has not been implemented yet.'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''591191c7-f693-5957-8734-ac87151ca981'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''86b4a49e-7378-5159-9f41-b005208c31bc'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''86b4a49e-7378-5159-9f41-b005208c31bc'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv'', ''synthetic_fail'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''NONE'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''c60cf3db-b1bf-5103-b278-b0c128ce924a'' as session_entry_id\n    FROM read_csv_auto(''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''synthetic_fail'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''c60cf3db-b1bf-5103-b278-b0c128ce924a'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in synthetic_fail.'',\n           ''Ensure synthetic_fail contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b10e248d-8c94-59ec-83fc-a1249dd3b111'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05e8feaa-0bed-5909-a817-39812494b361''', NULL, '[{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\ahc-hrsn-valid-01.xlsx\"},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"58821d95-8a89-47f3-af13-7be681531d40\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"9dd3301c-464b-43fa-89c4-97d79e57b86f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"9fef81b3-cd5d-4447-ae1d-9421207a3ded\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"020c16c7-b208-4bb9-8f2e-c4b64db30561\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"5d3e9ae5-a603-42b6-aac6-c29f27c9f086\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"dcf02031-a395-4b9c-a3dc-6c038f6d0e3e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"cfee50d5-6b5c-4526-b783-e1d60a7676bc\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"24c3f824-9559-4ea8-b5b3-be31fc6ba704\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"366661bc-9ace-480e-a598-e389647c8384\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"028364d1-8b23-4892-94ad-91e83a9101c2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"146e26dc-7378-4fff-8fd5-78cab94ae3cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"6c28fd55-b2ac-49c2-8874-8162a42dd784\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\ahc-hrsn-valid-01.xlsx\"},\r\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49\",\"orch_session_issue_id\":\"591191c7-f693-5957-8734-ac87151ca981\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"3b4eb0e5-6239-537a-8e67-e50e172e72a2\",\"orch_session_issue_id\":\"071f8fe1-4899-5c71-9c86-7d7377661d45\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"86b4a49e-7378-5159-9f41-b005208c31bc\",\"orch_session_issue_id\":\"a530fe1b-57ef-5a90-8bea-835ece2483da\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"a3fe7098-8ae8-5612-81ac-cbe10780c19b\",\"orch_session_issue_id\":\"99e72a60-96ab-5ef1-a3af-3e7759777664\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"e36daa69-3c63-5384-b6a7-03fa3b00641d\",\"orch_session_issue_id\":\"89f7ec04-277a-5799-afaa-a70d0f2a8ed5\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"72107c98-a89b-44c0-985e-6fe19502d326\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"262b3ee4-4854-410b-989d-94297e82fa57\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"d646b6eb-9067-40a5-bdca-0efb462c3706\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"863cb049-64d6-4ef4-a176-79222f4e6ddf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"09f5833f-732a-41b4-821a-63cf311d68cd\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"91b545b8-899e-4ea8-ba07-be3d09c8a27a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"ee83a333-4eba-4acc-98be-618a58903e1a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"f9a27b22-f294-40cf-8f07-a3ca9409fbc5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"4dbeba36-21b5-42e2-91e8-e9e3ebc493b1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"ab0a8a0c-476c-42c1-888d-d85a475c4762\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"1726d423-5198-4e54-adf2-bcdfa85882c7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"426869bc-0a6c-48fa-b5af-8fc88110c25b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"27f3492d-47e0-4288-abdd-330893c3fac3\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"576962a7-38c3-4b79-9b79-21aace807962\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"3f0206be-254e-46fc-b888-19c699916d4f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"6cbd3991-ed27-4385-b4ec-912c9b4bf63b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"74cc493d-f2fa-41ed-bd9f-51474f376322\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"93ca82f9-b3d0-4fe5-8e2e-76bb3bea3ebc\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"197d16a4-eb4e-445b-b441-7a74a2bf494a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"876cb960-7f73-4a2b-aaa9-15f1895198f2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"4d85a3e8-41f5-4247-b81f-d3f0c3b5fb2a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null}]\r\n', 'JSON', '\n## ingest\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv'', ''ahc_hrsn_12_12_2023_valid'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''NONE'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'' as session_entry_id\n    FROM read_csv_auto(''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-12-12-2023-valid.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_12_12_2023_valid'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_12_12_2023_valid.'',\n           ''Ensure ahc_hrsn_12_12_2023_valid contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_admin_demographic'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''Admin_Demographic'''' has not been implemented yet.'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_screening'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''47277588-99e8-59f5-8384-b24344a86073'', ''NONE'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''47277588-99e8-59f5-8384-b24344a86073'' as session_entry_id\n    FROM st_read(''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_valid_01_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_valid_01_screening.'',\n           ''Ensure ahc_hrsn_valid_01_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''47277588-99e8-59f5-8384-b24344a86073'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_q_e_admin_data'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''QE_Admin_Data'''' has not been implemented yet.'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''591191c7-f693-5957-8734-ac87151ca981'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''86b4a49e-7378-5159-9f41-b005208c31bc'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''86b4a49e-7378-5159-9f41-b005208c31bc'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv'', ''synthetic_fail'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''NONE'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''c60cf3db-b1bf-5103-b278-b0c128ce924a'' as session_entry_id\n    FROM read_csv_auto(''support\\assurance\\ahc-hrsn-elt\\screening\\synthetic-content\\synthetic-fail.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''synthetic_fail'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''c60cf3db-b1bf-5103-b278-b0c128ce924a'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in synthetic_fail.'',\n           ''Ensure synthetic_fail contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b10e248d-8c94-59ec-83fc-a1249dd3b111'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05e8feaa-0bed-5909-a817-39812494b361''\n```\n### `ingest` STDOUT (status: `0`)\n```json\n[{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\ahc-hrsn-valid-01.xlsx\"},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"58821d95-8a89-47f3-af13-7be681531d40\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"9dd3301c-464b-43fa-89c4-97d79e57b86f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"9fef81b3-cd5d-4447-ae1d-9421207a3ded\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"020c16c7-b208-4bb9-8f2e-c4b64db30561\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"5d3e9ae5-a603-42b6-aac6-c29f27c9f086\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"dcf02031-a395-4b9c-a3dc-6c038f6d0e3e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"cfee50d5-6b5c-4526-b783-e1d60a7676bc\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"24c3f824-9559-4ea8-b5b3-be31fc6ba704\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"366661bc-9ace-480e-a598-e389647c8384\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"028364d1-8b23-4892-94ad-91e83a9101c2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"146e26dc-7378-4fff-8fd5-78cab94ae3cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"6c28fd55-b2ac-49c2-8874-8162a42dd784\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\ahc-hrsn-valid-01.xlsx\"},\r\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49\",\"orch_session_issue_id\":\"591191c7-f693-5957-8734-ac87151ca981\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"3b4eb0e5-6239-537a-8e67-e50e172e72a2\",\"orch_session_issue_id\":\"071f8fe1-4899-5c71-9c86-7d7377661d45\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\jrchc-hrsn-file-spec.xlsx\"},\r\n{\"session_entry_id\":\"86b4a49e-7378-5159-9f41-b005208c31bc\",\"orch_session_issue_id\":\"a530fe1b-57ef-5a90-8bea-835ece2483da\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"a3fe7098-8ae8-5612-81ac-cbe10780c19b\",\"orch_session_issue_id\":\"99e72a60-96ab-5ef1-a3af-3e7759777664\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"e36daa69-3c63-5384-b6a7-03fa3b00641d\",\"orch_session_issue_id\":\"89f7ec04-277a-5799-afaa-a70d0f2a8ed5\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support\\\\assurance\\\\ahc-hrsn-elt\\\\screening\\\\synthetic-content\\\\synthetic-fail-excel-01.xlsx\"},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"72107c98-a89b-44c0-985e-6fe19502d326\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"262b3ee4-4854-410b-989d-94297e82fa57\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"d646b6eb-9067-40a5-bdca-0efb462c3706\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"863cb049-64d6-4ef4-a176-79222f4e6ddf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"09f5833f-732a-41b4-821a-63cf311d68cd\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"91b545b8-899e-4ea8-ba07-be3d09c8a27a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"ee83a333-4eba-4acc-98be-618a58903e1a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"f9a27b22-f294-40cf-8f07-a3ca9409fbc5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"4dbeba36-21b5-42e2-91e8-e9e3ebc493b1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"ab0a8a0c-476c-42c1-888d-d85a475c4762\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"1726d423-5198-4e54-adf2-bcdfa85882c7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"426869bc-0a6c-48fa-b5af-8fc88110c25b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"27f3492d-47e0-4288-abdd-330893c3fac3\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"576962a7-38c3-4b79-9b79-21aace807962\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"3f0206be-254e-46fc-b888-19c699916d4f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"6cbd3991-ed27-4385-b4ec-912c9b4bf63b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"74cc493d-f2fa-41ed-bd9f-51474f376322\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"93ca82f9-b3d0-4fe5-8e2e-76bb3bea3ebc\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"197d16a4-eb4e-445b-b441-7a74a2bf494a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"876cb960-7f73-4a2b-aaa9-15f1895198f2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\r\n{\"session_entry_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"orch_session_issue_id\":\"4d85a3e8-41f5-4247-b81f-d3f0c3b5fb2a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null}]\r\n\n```\nNo STDERR emitted by `ingest`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'ensureContent', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NULL\n        OR TRIM(PAT_MRN_ID) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NOT NULL\n       AND PAT_MRN_ID NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME IS NULL\n        OR TRIM(FIRST_NAME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME NOT SIMILAR TO ''%[A-Za-z]%''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern %[A-Za-z]%'',\n           ''Follow the pattern %[A-Za-z]% in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME IS NULL\n        OR TRIM(LAST_NAME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME NOT SIMILAR TO ''%[A-Za-z]%''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern %[A-Za-z]%'',\n           ''Follow the pattern %[A-Za-z]% in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_BIRTH_DATE IS NULL\n        OR TRIM(PAT_BIRTH_DATE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE PAT_BIRTH_DATE IS NOT NULL\n    AND TRY_CAST(PAT_BIRTH_DATE AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(YEAR FROM PAT_BIRTH_DATE) >= 1915 \n      AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) <= EXTRACT(YEAR FROM CURRENT_DATE)\n      AND EXTRACT(MONTH FROM PAT_BIRTH_DATE) BETWEEN 1 AND 12\n      AND (\n         (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (1, 3, 5, 7, 8, 10, 12) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 31)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (4, 6, 9, 11) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 30)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2\n             AND (\n                (EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 4 = 0 AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 100 != 0)\n                OR EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 400 = 0\n             )\n             AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 29\n         )\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2 AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 28)\n      )\n   )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Birth Date \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Is complete across all rows.  Date of Birth is numeric and follows YYYY-MM-DD.  YYYY is not before 1915  or after current date.  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 1916x every 4 years, DD is between 1 and 29.''\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NULL\n        OR TRIM(MEDICAID_CIN) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NOT NULL\n       AND MEDICAID_CIN NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows; \nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_ID'' AS issue_column,\n           ENCOUNTER_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ENCOUNTER_ID IS NULL\n        OR TRIM(ENCOUNTER_ID) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE RECORDED_TIME IS NULL\n        OR TRIM(RECORDED_TIME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH valid_time_in_all_rows AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE RECORDED_TIME IS NOT NULL\n    AND TRY_CAST(RECORDED_TIME AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(year FROM RECORDED_TIME) >=  2023\n      AND EXTRACT(month FROM RECORDED_TIME) BETWEEN 1 AND 12\n      AND (\n          (EXTRACT(month FROM RECORDED_TIME) IN (01, 03, 05, 07, 08, 10, 12) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 31)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) IN (04, 06, 09, 11) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 30)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) = 02 AND (\n              (EXTRACT(year FROM RECORDED_TIME) % 4 = 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 29)\n              OR\n              (EXTRACT(year FROM RECORDED_TIME) % 4 != 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 27)\n          ))\n      )\n      AND EXTRACT(hour FROM RECORDED_TIME) BETWEEN 1 AND 24\n      AND EXTRACT(minute FROM RECORDED_TIME) BETWEEN 1 AND 59\n      AND EXTRACT(second FROM RECORDED_TIME) BETWEEN 1 AND 59\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid time \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Year must be greater than 2023 and  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 2024x every 4 years, DD is between 1 and 29.  HH is between 1 and 24.  MM is between 1 and 59.  SS is between 1 and 59.''\n      FROM valid_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION'' AS issue_column,\n           QUESTION AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION IS NULL\n        OR TRIM(QUESTION) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''MEAS_VALUE'' AS issue_column,\n           MEAS_VALUE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEAS_VALUE IS NULL\n        OR TRIM(MEAS_VALUE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE IS NULL\n        OR TRIM(QUESTION_CODE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE NOT IN (71802-3,96778-6)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (71802-3,96778-6)'',\n           ''Use only allowed values 71802-3,96778-6 in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE'' AS issue_column,\n           ANSWER_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE IS NULL\n        OR TRIM(ANSWER_CODE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           ANSWER_CODE_SYSTEM_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE_SYSTEM_NAME IS NULL\n        OR TRIM(ANSWER_CODE_SYSTEM_NAME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           SDOH_DOMAIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SDOH_DOMAIN IS NULL\n        OR TRIM(SDOH_DOMAIN) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''NEED_INDICATED'' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED IS NULL\n        OR TRIM(NEED_INDICATED) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''NEED_INDICATED'' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG IS NULL\n        OR TRIM(VISIT_PART_2_FLAG) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG IS NULL\n        OR TRIM(VISIT_OMH_FLAG) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG IS NULL\n        OR TRIM(VISIT_OPWDD_FLAG) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3252fee6-3a9a-5f4c-81c6-739201046d79'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    ', NULL, NULL, NULL, '\n## ensureContent\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NULL\n        OR TRIM(PAT_MRN_ID) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           PAT_MRN_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_MRN_ID IS NOT NULL\n       AND PAT_MRN_ID NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME IS NULL\n        OR TRIM(FIRST_NAME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           FIRST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE FIRST_NAME NOT SIMILAR TO ''%[A-Za-z]%''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern %[A-Za-z]%'',\n           ''Follow the pattern %[A-Za-z]% in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME IS NULL\n        OR TRIM(LAST_NAME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           LAST_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE LAST_NAME NOT SIMILAR TO ''%[A-Za-z]%''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern %[A-Za-z]%'',\n           ''Follow the pattern %[A-Za-z]% in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE PAT_BIRTH_DATE IS NULL\n        OR TRIM(PAT_BIRTH_DATE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           PAT_BIRTH_DATE AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE PAT_BIRTH_DATE IS NOT NULL\n    AND TRY_CAST(PAT_BIRTH_DATE AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(YEAR FROM PAT_BIRTH_DATE) >= 1915 \n      AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) <= EXTRACT(YEAR FROM CURRENT_DATE)\n      AND EXTRACT(MONTH FROM PAT_BIRTH_DATE) BETWEEN 1 AND 12\n      AND (\n         (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (1, 3, 5, 7, 8, 10, 12) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 31)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) IN (4, 6, 9, 11) AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 30)\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2\n             AND (\n                (EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 4 = 0 AND EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 100 != 0)\n                OR EXTRACT(YEAR FROM PAT_BIRTH_DATE) % 400 = 0\n             )\n             AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 29\n         )\n         OR (EXTRACT(MONTH FROM PAT_BIRTH_DATE) = 2 AND EXTRACT(DAY FROM PAT_BIRTH_DATE) BETWEEN 1 AND 28)\n      )\n   )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Birth Date \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Is complete across all rows.  Date of Birth is numeric and follows YYYY-MM-DD.  YYYY is not before 1915  or after current date.  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 1916x every 4 years, DD is between 1 and 29.''\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NULL\n        OR TRIM(MEDICAID_CIN) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH numeric_value_in_all_rows AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           MEDICAID_CIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEDICAID_CIN IS NOT NULL\n       AND MEDICAID_CIN NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows; \nWITH mandatory_value AS (\n    SELECT ''ENCOUNTER_ID'' AS issue_column,\n           ENCOUNTER_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ENCOUNTER_ID IS NULL\n        OR TRIM(ENCOUNTER_ID) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE RECORDED_TIME IS NULL\n        OR TRIM(RECORDED_TIME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH valid_time_in_all_rows AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           RECORDED_TIME AS invalid_value,\n           src_file_row_number AS issue_row\n    FROM ahc_hrsn_12_12_2023_valid\n    WHERE RECORDED_TIME IS NOT NULL\n    AND TRY_CAST(RECORDED_TIME AS DATE) IS NOT NULL\n    AND NOT (\n      EXTRACT(year FROM RECORDED_TIME) >=  2023\n      AND EXTRACT(month FROM RECORDED_TIME) BETWEEN 1 AND 12\n      AND (\n          (EXTRACT(month FROM RECORDED_TIME) IN (01, 03, 05, 07, 08, 10, 12) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 31)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) IN (04, 06, 09, 11) AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 30)\n          OR\n          (EXTRACT(month FROM RECORDED_TIME) = 02 AND (\n              (EXTRACT(year FROM RECORDED_TIME) % 4 = 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 29)\n              OR\n              (EXTRACT(year FROM RECORDED_TIME) % 4 != 0 AND EXTRACT(day FROM RECORDED_TIME) BETWEEN 1 AND 27)\n          ))\n      )\n      AND EXTRACT(hour FROM RECORDED_TIME) BETWEEN 1 AND 24\n      AND EXTRACT(minute FROM RECORDED_TIME) BETWEEN 1 AND 59\n      AND EXTRACT(second FROM RECORDED_TIME) BETWEEN 1 AND 59\n  )\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid time \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Year must be greater than 2023 and  MM is between 1 and 12.  DD is between 1 and 31 for MM- 01, 03, 05, 07, 08, 10, 12.  DD is between 1 and 30 for MM- 04, 06, 09, 11  DD is between 1 and 27 for MM- 02 unless YYYY is 2024x every 4 years, DD is between 1 and 29.  HH is between 1 and 24.  MM is between 1 and 59.  SS is between 1 and 59.''\n      FROM valid_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION'' AS issue_column,\n           QUESTION AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION IS NULL\n        OR TRIM(QUESTION) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''MEAS_VALUE'' AS issue_column,\n           MEAS_VALUE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE MEAS_VALUE IS NULL\n        OR TRIM(MEAS_VALUE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE IS NULL\n        OR TRIM(QUESTION_CODE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           QUESTION_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE QUESTION_CODE NOT IN (71802-3,96778-6)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (71802-3,96778-6)'',\n           ''Use only allowed values 71802-3,96778-6 in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE'' AS issue_column,\n           ANSWER_CODE AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE IS NULL\n        OR TRIM(ANSWER_CODE) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           ANSWER_CODE_SYSTEM_NAME AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE ANSWER_CODE_SYSTEM_NAME IS NULL\n        OR TRIM(ANSWER_CODE_SYSTEM_NAME) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           SDOH_DOMAIN AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SDOH_DOMAIN IS NULL\n        OR TRIM(SDOH_DOMAIN) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''NEED_INDICATED'' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED IS NULL\n        OR TRIM(NEED_INDICATED) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''NEED_INDICATED'' AS issue_column,\n           NEED_INDICATED AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE NEED_INDICATED NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG IS NULL\n        OR TRIM(VISIT_PART_2_FLAG) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           VISIT_PART_2_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_PART_2_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG IS NULL\n        OR TRIM(VISIT_OMH_FLAG) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           VISIT_OMH_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OMH_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG IS NULL\n        OR TRIM(VISIT_OPWDD_FLAG) = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           VISIT_OPWDD_FLAG AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE VISIT_OPWDD_FLAG NOT IN (TRUE,FALSE)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (TRUE,FALSE)'',\n           ''Use only allowed values TRUE,FALSE in '' || issue_column\n      FROM allowed_values;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3252fee6-3a9a-5f4c-81c6-739201046d79'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n```\nNo STDOUT emitted by `ensureContent` (status: `0`).\n\nNo STDERR emitted by `ensureContent`.\n\n    ', NULL);;\n-- diagnostics-md-ignore-finish \"SQLPage and execution diagnostics SQL DML\"\n\nATTACH 'support/assurance/ahc-hrsn-elt/screening/results-test-e2e/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n-- copy relevant orchestration engine admin tables into the the attached database\nCREATE TABLE resource_db.device AS SELECT * FROM device;\nCREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\nCREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\nCREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\nCREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\nCREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\nCREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n-- export content tables from DuckDb into the attached database (nature-dependent)\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ASSURED_CSV', 'ATTEMPT_CSV_EXPORT', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\nCREATE TABLE resource_db.ahc_hrsn_12_12_2023_valid AS SELECT * FROM ahc_hrsn_12_12_2023_valid;\n\nCREATE VIEW resource_db.ahc_hrsn_12_12_2023_valid_fhir AS \n  SELECT pat_mrn_id, json_object(\n        'resourceType', 'Observation',\n        'id', ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', QUESTION_CODE_SYSTEM_NAME,\n                    'code', QUESTION_CODE,\n                    'display', QUESTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID\n        ),\n        'effectiveDateTime', RECORDED_TIME,\n        'valueString', MEAS_VALUE,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM ahc_hrsn_12_12_2023_valid;\n  \n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('46171763-bd21-57a8-a403-0785f72643cf', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_EXPORT', 'CSV_EXPORTED', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  ;\n\nDETACH DATABASE resource_db;\n\n-- no after-finalize SQL provided",
        "session_id": "05e8feaa-0bed-5909-a817-39812494b361",
        "narrative_md": "\n## emitResources\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8f460419-7b80-516d-8919-84520950f612', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7bab389e-54af-5a13-a39f-079abdc73a48', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1931dfcc-e8fc-597d-b1bc-65b4287e6fdf', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('fa7874f6-f848-572b-a9ab-9db4c8d5e959', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9860873a-c387-5d98-9930-4ff296eb7192', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 3, 14, 30, 27.108)), NULL);\n\n-- removed SQLPage and execution diagnostics SQL DML from diagnostics Markdown\n\nATTACH 'support/assurance/ahc-hrsn-elt/screening/results-test-e2e/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n-- copy relevant orchestration engine admin tables into the the attached database\nCREATE TABLE resource_db.device AS SELECT * FROM device;\nCREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\nCREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\nCREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\nCREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\nCREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\nCREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n-- export content tables from DuckDb into the attached database (nature-dependent)\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ASSURED_CSV', 'ATTEMPT_CSV_EXPORT', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\nCREATE TABLE resource_db.ahc_hrsn_12_12_2023_valid AS SELECT * FROM ahc_hrsn_12_12_2023_valid;\n\nCREATE VIEW resource_db.ahc_hrsn_12_12_2023_valid_fhir AS \n  SELECT pat_mrn_id, json_object(\n        'resourceType', 'Observation',\n        'id', ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', QUESTION_CODE_SYSTEM_NAME,\n                    'code', QUESTION_CODE,\n                    'display', QUESTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID\n        ),\n        'effectiveDateTime', RECORDED_TIME,\n        'valueString', MEAS_VALUE,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM ahc_hrsn_12_12_2023_valid;\n  \n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('46171763-bd21-57a8-a403-0785f72643cf', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_EXPORT', 'CSV_EXPORTED', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  ;\n\nDETACH DATABASE resource_db;\n\n-- no after-finalize SQL provided\n```\nNo STDOUT emitted by `emitResources` (status: `0`).\n\nNo STDERR emitted by `emitResources`.\n\n    "
      }
    },
    {
      "insertable": {
        "exec_identity": "emitDiagnostics",
        "exec_code": "duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_diagnostic_text) TO 'support/assurance/ahc-hrsn-elt/screening/results-test-e2e/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');",
        "orch_session_exec_id": "8640a4b5-53ef-506e-bcde-83f00315d4b2",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_diagnostic_text) TO 'support/assurance/ahc-hrsn-elt/screening/results-test-e2e/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');",
        "session_id": "05e8feaa-0bed-5909-a817-39812494b361",
        "narrative_md": "\n## emitDiagnostics\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_diagnostic_text) TO 'support/assurance/ahc-hrsn-elt/screening/results-test-e2e/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');\n```\nNo STDOUT emitted by `emitDiagnostics` (status: `0`).\n\nNo STDERR emitted by `emitDiagnostics`.\n\n    "
      }
    }
  ]
}